(function(n){n.loader.getState("ext.gadget.store.FandoomUiUtilsModal")===null&&n.loader.load("https://cdn.jsdelivr.net/gh/ccxtwf/MirahezeDevScripts@dist/dist@1.0.0/FandoomUiUtilsModal/gadget-impl.js"),n.loader.getState("ext.gadget.store.PowertoolsPlacement")===null&&n.loader.load("https://cdn.jsdelivr.net/gh/ccxtwf/MirahezeDevScripts@dist/dist@1.0.0/PowertoolsPlacement/gadget-impl.js"),n.loader.getState("ext.gadget.store.FandoomUtilsI18nLoader")===null&&n.loader.load("https://cdn.jsdelivr.net/gh/ccxtwf/MirahezeDevScripts@dist/dist@1.0.0/FandoomUtilsI18nLoader/gadget-impl.js"),n.loader.impl(function(){return["ext.gadget.store.MassRename@ab881263",function(s,U,D,I){n.loader.using("mediawiki.api",function(){if(window.MassRenameLoaded||!/sysop|bureaucrat|global-admin/.test(n.config.get("wgUserGroups").join()))return;window.MassRenameLoaded=!0;var t,r,b=3,u=!1,d,p,g,f,c;function x(){return s("<form>").append(s("<fieldset>").append(s("<p>",{text:t.msg("instructions").plain()}),s("<p>",{text:t.msg("instructions2").plain()}),s("<label>",{for:"redirect-check",text:t.msg("redirect").plain()}).append(s("<input>",{type:"checkbox",id:"redirect-check"})),s("<div>",{class:"edit-input-control"}).append(s("<label>",{for:"custom-summary"}).append(s("<div>").text(t.msg("custom-summary").plain()),s("<input>",{id:"custom-summary"}))),s("<textarea>",{id:"text-rename",placeholder:"old_name new_name"}),s("<div>",{id:"text-error-output",text:t.msg("outputInitial").plain(),append:"<br/>"}))).prop("outerHTML")}function m(){--b===0&&y()}function y(){n.libs.PowertoolsPlacement.addPortletLink(n.config.values.skin,{id:"t-mr",href:"#",label:t.msg("title").plain(),tooltip:"MassRename",onClick:w})}function w(){if(r){r.show();return}r=new window.dev.modal.Modal({content:x(),id:"form-mass-rename",size:"medium",title:t.msg("title").escape(),buttons:[{id:"mr1-start",text:t.msg("initiate").escape(),primary:!0,event:"start"},{id:"mr1-pause",text:t.msg("pause").escape(),primary:!0,event:"pause",disabled:!0},{text:t.msg("close").escape(),event:"close"}],events:{pause:h,start:M}}),r.create(),d=s("#form-mass-rename"),p=d.find("#text-rename"),g=d.find("#custom-summary"),f=d.find("#redirect-check"),c=d.find("#text-error-output"),r.show()}function h(){u=!0,r.disableActionButtons("mr1-pause"),r.enableActionButtons("mr1-start")}function M(){u=!1,r.disableActionButtons("mr1-start"),r.enableActionButtons("mr1-pause"),v()}function v(){if(!u){var e=(p.val()||"").split(`
`),a=e[0];a?k(a):(c.append(t.msg("finished").escape()+" "+t.msg("nothingLeftToDo").escape()+"<br/>"),h()),e=e.slice(1,e.length),p.val(e.join(`
`))}}function k(e){if(e.split(" ").length!==2)c.append(t.msg("invalidInput",e).escape()+"<br/>");else{var a=e.split(" ")[0],o=e.split(" ")[1],i={action:"move",from:a,to:o,noredirect:"",reason:g.first().val()||window.massRenameSummary||t.inContentLang().msg("summary").plain()};f.prop("checked")&&delete i.noredirect,new n.Api().postWithEditToken(i).done(function(l){l.error?(console.error(t.msg("renameFail",a,o).escape()+": "+l.error.code),c.append(t.msg("renameFail",a,o).escape()+": "+l.error.code+"<br/>")):console.log(t.msg("renameDone",a,o).plain())}).fail(function(l){console.error(t.msg("renameFail",a,o).plain()+": "+l),c.append(t.msg("renameFail2",a,o).escape()+"<br/>")})}setTimeout(v,window.massRenameDelay||1e3)}n.hook("dev.modal").add(m),n.hook("dev.powertools.placement").add(m),P().then(function(e){t=F(e),m()});function F(e){var a=n.Message;a.prototype.constructor=n.Message.prototype.constructor;var o={_i18nLoader:e,msg:function(){var i=Array.prototype.slice.call(arguments);if(i.length!==0){var l=i.shift();return new a(this._i18nLoader.getMessages(),l,i)}}};return["setTempLang","setDefaultLang"].forEach(function(i){o[i]=o._i18nLoader[i].bind(o._i18nLoader)}),["useLang","usePageLang","useContentLang","usePageViewLang","useUserLang","inLang","inPageLang","inContentLang","inPageViewLang","inUserLang"].forEach(function(i){o[i]=o._i18nLoader[i].bind(o)}),o}function P(){var e=new s.Deferred;return n.loader.using("ext.gadget.store.FandoomUtilsI18nLoader").done(function(a){var o=a("ext.gadget.store.FandoomUtilsI18nLoader");o.loadMessages("MassRename",{}).done(function(i){if(!i){e.resolve(L());return}e.resolve(i)})}).fail(function(a){console.error(a),e.resolve(L())}),e}function L(){console.warn("[FandoomUtilsI18nLoader] Failed to load messages. Using fallback messages instead.");var e=new n.Map;e.set({title:"Mass rename",instructions:"Put the name of the page you want to rename, then the new name afterwards with a space in between on each separate line.",instructions2:"For page names with spaces, use underscores instead of spaces.",redirect:"Leave a redirect behind?",summary:"automatic",outputInitial:"Any errors encountered will appear below",initiate:"Initiate",cancel:"Cancel",finished:"Finished!",nothingLeftToDo:"Nothing left to do, or next line is blank.",close:"Close",renameDone:"Successfully renamed $1 to $2!",invalidInput:'The line "$1" is invalid input!',renameFail:"Failed to rename $1 to $2",renameFail2:"Failed to rename $1 to $2!",pause:"Pause","custom-summary":"Reason for moving "}),n.Message.prototype.escape===void 0&&(n.Message.prototype.escape=n.Message.prototype.escaped);var a={getMessages:function(){return e}};return["setDefaultLang","setTempLang","useLang","usePageLang","useContentLang","usePageViewLang","useUserLang"].forEach(function(o){a[o]=s.noop}),["inLang","inPageLang","inContentLang","inPageViewLang","inUserLang"].forEach(function(o){a[o]=function(){return this}}),a}})},{css:["#form-mass-rename #text-rename{height:20em;resize:none;width:100%}#form-mass-rename #text-error-output{background-color:#ffbfbf;color:#000;font-weight:700;width:100%;overflow:scroll}#form-mass-rename #my-tools-menu .custom{cursor:pointer}#form-mass-rename .edit-input-control{margin-top:5px;margin-bottom:15px}#form-mass-rename .edit-input-control>label>*{display:block;width:100%;box-sizing:border-box}"]},{},{},null]})})(mediaWiki);
