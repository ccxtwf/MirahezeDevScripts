(function(n){["sysop","bureaucrat","global-admin"].some(function(a){return(n.config.get("wgUserRights")||[]).indexOf(a)>-1})&&(n.loader.getState("ext.gadget.store.FandoomUiUtilsModal")===null&&n.loader.load("https://cdn.jsdelivr.net/gh/ccxtwf/MirahezeDevScripts@5ef63c7fbb0092861de7a34c7d9ed87336f617cf/dist/FandoomUiUtilsModal/gadget-impl.js"),n.loader.getState("ext.gadget.store.PowertoolsPlacement")===null&&n.loader.load("https://cdn.jsdelivr.net/gh/ccxtwf/MirahezeDevScripts@5ef63c7fbb0092861de7a34c7d9ed87336f617cf/dist/PowertoolsPlacement/gadget-impl.js"),n.loader.impl(function(){return["ext.gadget.store.AjaxBatchDelete@310cadab",function(a,T,B,E){n.loader.using("mediawiki.api",function(){"use strict";if(window.AjaxBatchDeleteLoaded)return;window.AjaxBatchDeleteLoaded=!0;var p=new n.Api,i,L=3,s,g=!0,l,u,c,x,f;function h(){--L===0&&w()}function w(){n.libs.PowertoolsPlacement.addPortletLink(n.config.values.skin,{id:"t-bd",href:"#",label:i.msg("toolsTitle").plain(),tooltip:"AjaxBatchDelete",onClick:P})}function P(){if(s){s.show();return}s=new window.dev.modal.Modal({content:j(),id:"form-batch-delete",size:"large",title:i.msg("modalTitle").escape(),buttons:[{id:"abd-start",text:i.msg("initiate").escape(),primary:!0,event:"start"},{id:"abd-pause",text:i.msg("pause").escape(),primary:!0,event:"pause",disabled:!0},{id:"abd-add-pages-in-category",text:i.msg("addCategoryContents").escape(),primary:!0,event:"addCategoryContents"}],events:{addCategoryContents:D,pause:y,start:k}}),s.create(),l=a("#form-batch-delete"),f=l.find("#text-error-output"),c=l.find("#text-mass-delete"),u=l.find("#ajax-delete-reason"),x=l.find("#protect-check"),s.show()}function j(){return a("<form>").append(a("<fieldset>").append(a("<div>",{class:"edit-input-controls"}).append(a("<div>",{class:"edit-input-control"}).append(a("<label>",{for:"ajax-delete-reason",text:i.msg("inputReason").plain()}),a("<input>",{type:"text",name:"ajax-delete-reason",id:"ajax-delete-reason"})),a("<div>",{class:"edit-input-control"}).append(a("<label>",{for:"protect-check",text:i.msg("inputProtect").plain()}),a("<input>",{type:"checkbox",id:"protect-check",name:"protect-check"}))),a("<p>",{text:i.msg("inputPages").plain()+":"}),a("<textarea>",{id:"text-mass-delete"}),a("<p>",{text:i.msg("errorsForm").plain()+":"}),a("<div>",{id:"text-error-output"}))).prop("outerHTML")}function y(){g=!0,s.disableActionButtons("abd-pause"),s.enableActionButtons(["abd-start","abd-add-pages-in-category"])}function k(){if(!u.val()){alert(i.msg("stateReason").plain());return}g=!1,s.disableActionButtons(["abd-start","abd-add-pages-in-category"]),s.enableActionButtons("abd-pause"),v()}function v(){if(!g){var e=(c.val()||"").split(`
`),t=e[0];t?C(t,u.val()):(f.append(i.msg("endTitle").escape()+" "+i.msg("endMsg").escape()+"<br />"),y()),e=e.slice(1,e.length),c.val(e.join(`
`))}}function D(){var e=prompt(i.msg("enterCategory").plain()+":");e&&p.get({action:"query",list:"categorymembers",cmtitle:"Category:"+e,cmlimit:5e3}).done(function(t){var o=t.query;for(var r in o.categorymembers)c.val((c.val()||"")+o.categorymembers[r].title+`
`)}).fail(function(t){m("GetContents",e,t)})}function m(e,t,o){f.append(i.msg("error"+e,t,o).escape(),"<br />")}function C(e,t){p.postWithEditToken({action:"delete",watchlist:"preferences",title:e,reason:t,bot:!0}).done(function(){x.prop("checked")&&p.postWithEditToken({action:"protect",expiry:"infinite",protections:"create=sysop",watchlist:"preferences",title:e,reason:t}).fail(function(){m("Protect",e,i.msg("ajaxError").plain())})}).fail(function(o){m("Delete",e,o)}),setTimeout(v,window.batchDeleteDelay||1e3)}n.hook("dev.modal").add(h),n.hook("dev.powertools.placement").add(h),A().then(function(e){i=M(e),h()});function M(e){var t=n.Message;t.prototype.constructor=n.Message.prototype.constructor;var o={_i18nLoader:e,msg:function(){var r=Array.prototype.slice.call(arguments);if(r.length!==0){var b=r.shift();return new t(this._i18nLoader.getMessages(),b,r)}}};return["setTempLang","setDefaultLang"].forEach(function(r){o[r]=o._i18nLoader[r].bind(o._i18nLoader)}),["useLang","usePageLang","useContentLang","usePageViewLang","useUserLang","inLang","inPageLang","inContentLang","inPageViewLang","inUserLang"].forEach(function(r){o[r]=o._i18nLoader[r].bind(o)}),o}function A(){var e=new a.Deferred,t=new a.Deferred;function o(){var d=a.Deferred();return n.loader.using("ext.gadget.store.FandoomUtilsI18nLoader").done(function(F){d.resolve(F("ext.gadget.store.FandoomUtilsI18nLoader"))}).fail(d.reject),d}function r(d){return d.loadMessages("AjaxBatchDelete",{})}function b(d){e.resolve(d)}return t.then(o).then(r).then(b).catch(function(d){console.error(d),e.resolve(U())}),n.loader.getState("ext.gadget.store.FandoomUtilsI18nLoader")?t.resolve():a.ajax({dataType:"script",cache:!0,url:"https://cdn.jsdelivr.net/gh/ccxtwf/MirahezeDevScripts@5ef63c7fbb0092861de7a34c7d9ed87336f617cf/dist/FandoomUtilsI18nLoader/gadget-impl.js"}).done(function(){t.resolve()}).fail(t.reject),e}function U(){console.warn("[FandoomUtilsI18nLoader] Failed to load messages. Using fallback messages instead.");var e=new n.Map;e.set({toolsTitle:"Batch Delete",modalTitle:"Ajax Batch Delete",inputReason:"Reason for deleting",inputProtect:"Protect for admin only?",inputPages:"Put the name of each page you want to delete on a separate line",errorsForm:"Any errors encountered will appear below",addCategoryContents:"Add category contents",initiate:"Initiate",stateReason:"Please state a reason!",endTitle:"Finished!",endMsg:"Nothing left to do, or next line is blank.",enterCategory:"Please enter the category name (no category prefix)",errorGetContents:"Failed to get contents of $1: $2",errorDelete:"Failed to delete $1: $2",errorProtect:"Failed to protect $1: $2",pause:"Pause"}),n.Message.prototype.escape===void 0&&(n.Message.prototype.escape=n.Message.prototype.escaped);var t={getMessages:function(){return e}};return["setDefaultLang","setTempLang","useLang","usePageLang","useContentLang","usePageViewLang","useUserLang"].forEach(function(o){t[o]=a.noop}),["inLang","inPageLang","inContentLang","inPageViewLang","inUserLang"].forEach(function(o){t[o]=function(){return this}}),t}})},{css:['#form-batch-delete #text-mass-delete{height:20em;resize:none;width:100%}#form-batch-delete #text-error-output{background-color:#ffbfbf;color:#000;font-weight:700;width:100%}#form-batch-delete .edit-input-control{display:flex;flex-direction:row;justify-content:flex-start;align-items:flex-start}#form-batch-delete .edit-input-control>label{width:200px;display:inline-block;flex-shrink:1}#form-batch-delete .edit-input-control > input[type="text"]{display:inline-block;flex-grow:2}@media(max-width:500px){#form-batch-delete .edit-input-control{flex-direction:column;justify-content:flex-start;align-items:flex-start}#form-batch-delete .edit-input-control>label{width:100%;display:block;flex-grow:2}#form-batch-delete .edit-input-control > input[type="text"]{width:100%;display:block;flex-grow:2}}']},{},{},null]}))})(mediaWiki);
