(function(s){"use strict";var N;function F(i){i[0].querySelectorAll(".html5audio:not(.loaded)").forEach(function(a){var n=a.dataset,t=[],l=[];for(var r in n)if(r.startsWith("file")){var v=r.substring(4),T=parseInt(v.substring(1))||(v===""?0:null);T!=null&&(t[T]=n[r])}t=t.filter(function(d){return d});for(var g=0;g<t.length;g++){var U=t[g],o;if(o=n["fileType"+(g>0?"-"+g:"")],!o){var c=t[g],_=c.lastIndexOf("?");_!=-1&&(c=c.substring(0,_));var E=c.lastIndexOf(".");E!=-1&&c.length-(E+1)<=4&&(o=c.substring(E+1))}o&&o.length>0&&(o=="mp3"&&(o="mpeg"),o.startsWith("audio/")||(o="audio/"+o));var m=document.createElement("source");m.src=U,o&&(m.type=o),l.push(m)}if(l.length!=0){var L=n.preload,V=n.download,y=n.options,p={controls:""},h=Number(Number(n.volume).toFixed(1)),P=parseFloat(n.start),A=parseFloat(n.end),f=parseFloat(n.repeatStart),u=parseFloat(n.repeatEnd);if(L!=="auto"&&L!=="metadata"&&(L="none"),p.preload=L,V==="false"&&(p.controlsList="nodownload"),y){var G=["autoplay","loop","muted"];y.split(",").forEach(function(d){d=d.trim(),G.indexOf(d)!==-1&&(p[d]="")})}var e=document.createElement("audio");if(Object.keys(p).forEach(function(d){var H=p[d];e.setAttribute(d,H)}),isNaN(P)||(e.currentTime=P),!isNaN(A)){var b=function(){e.currentTime>=A&&(e.seeking||e.pause(),e.removeEventListener("timeupdate",b))};e.addEventListener("timeupdate",b)}if(!isNaN(f)||!isNaN(u)){(isNaN(f)||f<0)&&(f=0),e.addEventListener("loadedmetadata",function(){(isNaN(u)||u>e.duration)&&(u=e.duration),f==0&&u==e.duration?(e.removeEventListener("timeupdate",C),e.removeEventListener("seeking",S),e.removeEventListener("ended",D),e.setAttribute("loop",""),M=!1):u>e.duration-.25&&e.removeAttribute("loop")});var M=!0,C=function(){M&&(e.paused&&!e.ended||e.currentTime>=u&&(e.currentTime=f))},S=function(){M=e.currentTime<u},D=function(){e.play()};e.addEventListener("ended",D),e.addEventListener("timeupdate",C),e.addEventListener("seeking",S)}Element.prototype.replaceChildren.apply(e,l),e.append(N("text").escape()),h>=0&&h<=1&&(e.volume=h),a.innerHTML="",a.appendChild(e),a.classList.add("loaded")}})}function I(i){var a=s.Message;a.prototype.constructor=s.Message.prototype.constructor;var n={_i18nLoader:i,msg:function(){var t=Array.prototype.slice.call(arguments);if(t.length!==0){var l=t.shift();return new a(this._i18nLoader.getMessages(),l,t)}}};return["setTempLang","setDefaultLang"].forEach(function(t){n[t]=n._i18nLoader[t].bind(n._i18nLoader)}),["useLang","usePageLang","useContentLang","usePageViewLang","useUserLang","inLang","inPageLang","inContentLang","inPageViewLang","inUserLang"].forEach(function(t){n[t]=n._i18nLoader[t].bind(n)}),n}function k(){var i=new $.Deferred,a=new $.Deferred;function n(){var r=$.Deferred();return s.loader.using("ext.gadget.store.FandoomUtilsI18nLoader").done(function(v){r.resolve(v("ext.gadget.store.FandoomUtilsI18nLoader"))}).fail(r.reject),r}function t(r){return r.loadMessages("HTMLAudioPlayer5",{})}function l(r){i.resolve(r)}return a.then(n).then(t).then(l).catch(function(r){console.error(r),i.resolve(w())}),s.loader.getState("ext.gadget.store.FandoomUtilsI18nLoader")?a.resolve():$.ajax({dataType:"script",cache:!0,url:"https://cdn.jsdelivr.net/gh/ccxtwf/MirahezeDevScripts@v0.0.3/dist/FandoomUtilsI18nLoader/gadget-impl.js"}).done(function(){a.resolve()}).fail(a.reject),i}function w(){console.warn("[FandoomUtilsI18nLoader] Failed to load messages. Using fallback messages instead.");var i=new s.Map;i.set({text:"Your browser does not support the &lt;audio&gt; tag."}),s.Message.prototype.escape===void 0&&(s.Message.prototype.escape=s.Message.prototype.escaped);var a={getMessages:function(){return i}};return["setDefaultLang","setTempLang","useLang","usePageLang","useContentLang","usePageViewLang","useUserLang"].forEach(function(n){a[n]=$.noop}),["inLang","inPageLang","inContentLang","inPageViewLang","inUserLang"].forEach(function(n){a[n]=function(){return this}}),a}k().then(function(i){var a=I(i);N=a.msg.bind(a),s.hook("wikipage.content").add(F)})})(window.mediaWiki);
